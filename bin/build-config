#!/usr/bin/env php
<?php
/**
 * Appfuel
 * Copyright (c) Robert Scott-Buccleuch <rsb.appfuel@gmail.com>
 * See LICENSE file at project root for details.
 */
use Appfuel\App\CliHandlerInterface;

$base   = realpath(__DIR__ . "/../");
$header = "$base/app/app-header.php";
if (! file_exists($header)) {
    fwrite(STDERR, "could not find app header at -($header) \n");
    exit(-1);
}

/*
 * Used to control the app-header.php script. $appType gives us cli handler
 * and configAction tells the header to replace the config data with ours.
 * Since we are the building configuration data we can not rely on config
 * data to be arround, so we use our own values
 */
$ctrl = array(
    'app-type'          => 'cli',
    'config-action'     => 'replace',
    'config-settings'   => array(
	    'php-error-level'			=> 'all strict',
	    'php-include-path'			=> array($base),
	    'php-include-path-replace'	=> 'replace',
	    'php-display-errors'		=> 'on',
	    'php-autoloader'			=> 'Appfuel\ClassLoader\StandardAutoloader',
	    'fault-handler-class'		=> 'Appfuel\Kernel\FaultHandler',
	    'php-default-timezone'		=> 'America/Los_Angeles'
    ),
);
$handler = require $header;
if (! $handler instanceof CliHandlerInterface) {
	$err  = "app handler was not created or does not implement Appfuel\App";
	$err .= "\CliHandlerInterface";
	fwrite(STDERR, $err);
}
echo "\n", print_r($handler,1), "\n";exit;



exit(0);
